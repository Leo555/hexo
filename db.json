{"meta":{"version":1,"warehouse":"1.0.3"},"models":{"Asset":[{"_id":"themes/apollo/source/scss/apollo.scss","path":"scss/apollo.scss","modified":1},{"_id":"themes/apollo/source/favicon.png","path":"favicon.png","modified":1},{"_id":"themes/apollo/source/css/apollo.css","path":"css/apollo.css","modified":1}],"Cache":[{"_id":"source/_posts/config-ssl-in-nginx.md","shasum":"95a6891a39fd4d45311610597e95da588923eb53","modified":1450537755000},{"_id":"source/_posts/install-nodejs-and-hexo-in-aliyun-centos.md","shasum":"b515839a950a751f3d813a38b98453f1545802d7","modified":1450499655000},{"_id":"source/_posts/hello-world.md","shasum":"774b507901d9b17991ace2a70263b6dd6d11999a","modified":1450449077000},{"_id":"themes/apollo/LICENSE","shasum":"6e31ac9076bfc8f09ae47977419eee4edfb63e5b","modified":1450495410000},{"_id":"themes/apollo/README.md","shasum":"fdaa691c63bba80c75b17e9426c06f148dfb9dc4","modified":1450495410000},{"_id":"themes/apollo/_config.yml","shasum":"d740b11c3133ce65f1f7f186422f3a11de63e7c4","modified":1450497974000},{"_id":"themes/apollo/doc/custom-blocks.md","shasum":"78e9400714d0ff7c9b272d3ccc80fb18c3bf208f","modified":1450495410000},{"_id":"themes/apollo/gulpfile.babel.js","shasum":"ae6ba496e2672ed07050295954ca3da8b0ef423c","modified":1450495410000},{"_id":"themes/apollo/layout/index.jade","shasum":"58c451042cad5beeb5a76852bba609c651ff3428","modified":1450495410000},{"_id":"themes/apollo/layout/mixins/paginator.jade","shasum":"510ee0ba37b4522cca6c6204d641809454ba3ac6","modified":1450495410000},{"_id":"themes/apollo/layout/mixins/post.jade","shasum":"37411bb13470bbfdb78b300ad4feffd2a2737086","modified":1450495410000},{"_id":"themes/apollo/layout/partial/comment.jade","shasum":"ff0a2c269c2434da2ac5529872f1d6184a71f96d","modified":1450495410000},{"_id":"themes/apollo/layout/partial/head.jade","shasum":"1dc82f6c2caac5419a1bd793f33b44b3490eddba","modified":1450532627000},{"_id":"themes/apollo/layout/partial/layout.jade","shasum":"d9c4f8933f6740f5159713ec69ab943db5fb7cae","modified":1450495410000},{"_id":"themes/apollo/layout/partial/scripts.jade","shasum":"ed937de186642bb8d11defc2b1c5cbf3388aa59e","modified":1450497749000},{"_id":"themes/apollo/layout/partial/nav.jade","shasum":"c35d3061da4b053b73150d9741c542d660798270","modified":1450495410000},{"_id":"themes/apollo/layout/post.jade","shasum":"7593ff041af04c387c457417237d9ab9e3cb467d","modified":1450495410000},{"_id":"themes/apollo/package.json","shasum":"a872d0158d522612ccc0b300bdf27d0228de8428","modified":1450495410000},{"_id":"themes/apollo/source/css/apollo.css","shasum":"2f4d716a8cbda4c8de6547624696adbc19c01881","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/base.scss","shasum":"88b361e68475caddbab763feed5e1db788ac2cd7","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/footer.scss","shasum":"60cf365489c0d93cd7e9f10eedd4aee702e1ef27","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/header.scss","shasum":"d24cc6520f3faa7bb80610b858a92639eadcc289","modified":1450495410000},{"_id":"themes/apollo/source/favicon.png","shasum":"a9cdcb22d1e74d5480323e19d1983de5a6873b8c","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/normalize.scss","shasum":"fd0b27bed6f103ea95b08f698ea663ff576dbcf1","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/post.scss","shasum":"8ca0ffea647c28ed0b158635a142e43ae052b2f2","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/mq.scss","shasum":"0b9c7097136ac8e4a07d9702fc4dbe0345ac7596","modified":1450495410000},{"_id":"themes/apollo/source/scss/_partial/posts.scss","shasum":"92858015b8f3dcb4eb91b6dc41563b7aaa91b376","modified":1450495410000},{"_id":"themes/apollo/source/scss/apollo.scss","shasum":"f8b40223ea647b7c5627c344ead5c1a493bdd576","modified":1450495410000},{"_id":"public/scss/apollo.scss","modified":1450538180563,"shasum":"f8b40223ea647b7c5627c344ead5c1a493bdd576"},{"_id":"public/favicon.png","modified":1450538180568,"shasum":"a9cdcb22d1e74d5480323e19d1983de5a6873b8c"},{"_id":"public/css/apollo.css","modified":1450538180570,"shasum":"2f4d716a8cbda4c8de6547624696adbc19c01881"},{"_id":"public/2015/12/20/config-ssl-in-nginx/index.html","modified":1450538180755,"shasum":"cba65414981c2e922ccd53ea24017ecae3f2ec43"},{"_id":"public/2015/12/19/install-nodejs-and-hexo-in-aliyun-centos/index.html","modified":1450538180829,"shasum":"f2a8dd94273126f1a0fb25296cd2e64e239de7b7"},{"_id":"public/2015/12/18/hello-world/index.html","modified":1450538180878,"shasum":"dffd776e463891c1f8c1065a1122a249f1f561a7"},{"_id":"public/categories/blog/index.html","modified":1450538180927,"shasum":"a87229c7bb32471ef6a9eb93f870d1d0d7d6fc2a"},{"_id":"public/atom.xml","modified":1450538180930,"shasum":"6bd29033d24be889bbb93d263cd1a614d8b389e8"},{"_id":"public/archives/index.html","modified":1450538180969,"shasum":"56f225035e34dbc4d194a2d4a280ede26eed78c5"},{"_id":"public/archives/2015/index.html","modified":1450538181010,"shasum":"56f225035e34dbc4d194a2d4a280ede26eed78c5"},{"_id":"public/archives/2015/12/index.html","modified":1450538181048,"shasum":"56f225035e34dbc4d194a2d4a280ede26eed78c5"},{"_id":"public/sitemap.xml","modified":1450538181050,"shasum":"9e497eb203f683ef000d8cd007df93a885e5ecd0"},{"_id":"public/tags/aliyun/index.html","modified":1450538181094,"shasum":"a87229c7bb32471ef6a9eb93f870d1d0d7d6fc2a"},{"_id":"public/tags/ecs/index.html","modified":1450538181121,"shasum":"a87229c7bb32471ef6a9eb93f870d1d0d7d6fc2a"},{"_id":"public/tags/centos/index.html","modified":1450538181164,"shasum":"a87229c7bb32471ef6a9eb93f870d1d0d7d6fc2a"},{"_id":"public/tags/nginx/index.html","modified":1450538181201,"shasum":"b94230121a7ba784eaacdc25061e8c20ed4a93df"},{"_id":"public/tags/ssl/index.html","modified":1450538181235,"shasum":"b94230121a7ba784eaacdc25061e8c20ed4a93df"},{"_id":"public/tags/https/index.html","modified":1450538181272,"shasum":"b94230121a7ba784eaacdc25061e8c20ed4a93df"},{"_id":"public/tags/nodejs/index.html","modified":1450538181308,"shasum":"3e57ae576b1eeeceed0b15dc84517b4f5fc99111"},{"_id":"public/tags/hexo/index.html","modified":1450538181349,"shasum":"3e57ae576b1eeeceed0b15dc84517b4f5fc99111"},{"_id":"public/index.html","modified":1450538181383,"shasum":"89eef49893b8b1bc9f88c9f46debfe1ca6003227"}],"Category":[{"name":"blog","_id":"ciid8zaq90001pexxp5rb146x"}],"Data":[],"Page":[],"Post":[{"title":"nginx配置ssl","date":"2015-12-20T14:01:05.000Z","_content":"今天给服务器安装了nginx，并配置了ssl，网址左边终于有萌萌哒的小绿锁了，这里还是做一下记录。\n\n<!--more-->\n\n先是安装nginx\n\n{% codeblock %}\nwget http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\nrpm -ivh nginx-release-centos-7-0.el7.ngx.noarch.rpm\nyum install nginx\n{% endcodeblock %}\n\n启动nginx\n\n{% codeblock %}\nsystemctl start nginx\n{% endcodeblock %}\n\n这样nginx服务就已经可以访问了，然后我们需要把hexo服务的4000端口转发到nginx的80端口，修改`/etc/nginx/conf.d/default.conf`\n\n{% codeblock %}\nserver {\n    listen       80;\n    server_name  ppxu.me *.ppxu.me;\n\n    location / {\n        proxy_pass          http://127.0.0.1:4000/;\n        proxy_redirect      off;\n        proxy_set_header    X-Real-IP       $remote_addr;\n        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    ...\n{% endcodeblock %}\n\n重启nginx\n\n{% codeblock %}\nsystemctl restart nginx\n{% endcodeblock %}\n\n现在访问网站，在响应头里就可以看到`Server:nginx/1.8.0`，说明nginx环境已经正常了，下面准备搞上HTTPS。\n\n这里就不详述HTTPS的原理了，对我们这个小博客而言，搞个免费的SSL证书就可以了，这里推荐[https://startssl.com/](https://startssl.com/)或者[https://www.wosign.com/](https://www.wosign.com/)，申请成功后把下载下来的对应版本的证书文件上传到服务器上，包含公钥`.crt`和私钥`.key`。\n\n然后编辑`/etc/nginx/conf.d/default.conf`\n\n{% codeblock %}\nserver {\n    listen       80;\n    listen       443 ssl;\n    server_name  ppxu.me *.ppxu.me;\n\n    ssl on;\n    ssl_certificate /etc/nginx/conf.d/ppxu.crt;\n    ssl_certificate_key /etc/nginx/conf.d/ppxu.key;\n    ssl_session_timeout 5m;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'AES128+EECDH:AES128+EDH:!aNULL';\n    ssl_prefer_server_ciphers on;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    ssl_stapling on;\n    ssl_stapling_verify on;\n\n    resolver 8.8.4.4 8.8.8.8 valid=300s;\n    resolver_timeout 10s;\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubdomains\";\n\n    location / {\n        # root   /usr/share/nginx/html;\n        # index  index.html index.htm;\n        proxy_pass          http://127.0.0.1:4000/;\n        proxy_redirect      off;\n        proxy_set_header    X-Real-IP       $remote_addr;\n        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    ...\n{% endcodeblock %}\n\n重启nginx，如果一切顺利，现在就可以通过`https://ppxu.me`访问到本网站了，但是直接输入`ppxu.me`会报400错误，显示\n\n{% codeblock %}\nThe plain HTTP request was sent to HTTPS port\n{% endcodeblock %}\n\n我们需要将http的请求强制使用https访问，这里有一个方法是使用497错误码做重定向，在`/etc/nginx/conf.d/default.conf`中添加\n\n{% codeblock %}\nerror_page 497  https://$host$uri;\n{% endcodeblock %}\n\n这样我们的网站就已经完全支持了HTTPS访问，可以在这个网站[https://www.ssllabs.com/ssltest/analyze.html](https://www.ssllabs.com/ssltest/analyze.html)对网页进行安全评测，如果评分不够高的话可以再看看如何[加强nginx的SSL安全](http://www.oschina.net/translate/strong_ssl_security_on_nginx)\n\n#### 参考资料\n\n* [http://codybonney.com/installing-nginx-on-centos-6-4/](http://codybonney.com/installing-nginx-on-centos-6-4/)\n* [http://www.tuijiankan.com/2015/05/04/阿里云Centos6安装配置Nodejs、Nginx、Hexo操作记录/](http://www.tuijiankan.com/2015/05/04/%E9%98%BF%E9%87%8C%E4%BA%91Centos6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AENodejs%E3%80%81Nginx%E3%80%81Hexo%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/)\n* [http://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/](http://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/)\n* [http://www.ha97.com/5194.html](http://www.ha97.com/5194.html)\n* [http://www.cnblogs.com/yanghuahui/archive/2012/06/25/2561568.html](http://www.cnblogs.com/yanghuahui/archive/2012/06/25/2561568.html)\n* [http://www.codeceo.com/article/nginx-ssl-nodejs.html](http://www.codeceo.com/article/nginx-ssl-nodejs.html)\n* [http://www.ttlsa.com/nginx/nginx-node-js/](http://www.ttlsa.com/nginx/nginx-node-js/)\n* [http://blog.csdn.net/wzy_1988/article/details/8549290](http://blog.csdn.net/wzy_1988/article/details/8549290)\n* [http://www.tutugreen.com/wordpress/upgrade-ssl/](http://www.tutugreen.com/wordpress/upgrade-ssl/)\n* [http://www.oschina.net/translate/strong_ssl_security_on_nginx](http://www.oschina.net/translate/strong_ssl_security_on_nginx)\n* [http://blog.jobbole.com/44844/](http://blog.jobbole.com/44844/)\n","source":"_posts/config-ssl-in-nginx.md","raw":"title: nginx配置ssl\ndate: 2015-12-20 22:01:05\ncategories: blog\ntags: [aliyun, ecs, centos, nginx, ssl, https]\n---\n今天给服务器安装了nginx，并配置了ssl，网址左边终于有萌萌哒的小绿锁了，这里还是做一下记录。\n\n<!--more-->\n\n先是安装nginx\n\n{% codeblock %}\nwget http://nginx.org/packages/centos/7/noarch/RPMS/nginx-release-centos-7-0.el7.ngx.noarch.rpm\nrpm -ivh nginx-release-centos-7-0.el7.ngx.noarch.rpm\nyum install nginx\n{% endcodeblock %}\n\n启动nginx\n\n{% codeblock %}\nsystemctl start nginx\n{% endcodeblock %}\n\n这样nginx服务就已经可以访问了，然后我们需要把hexo服务的4000端口转发到nginx的80端口，修改`/etc/nginx/conf.d/default.conf`\n\n{% codeblock %}\nserver {\n    listen       80;\n    server_name  ppxu.me *.ppxu.me;\n\n    location / {\n        proxy_pass          http://127.0.0.1:4000/;\n        proxy_redirect      off;\n        proxy_set_header    X-Real-IP       $remote_addr;\n        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    ...\n{% endcodeblock %}\n\n重启nginx\n\n{% codeblock %}\nsystemctl restart nginx\n{% endcodeblock %}\n\n现在访问网站，在响应头里就可以看到`Server:nginx/1.8.0`，说明nginx环境已经正常了，下面准备搞上HTTPS。\n\n这里就不详述HTTPS的原理了，对我们这个小博客而言，搞个免费的SSL证书就可以了，这里推荐[https://startssl.com/](https://startssl.com/)或者[https://www.wosign.com/](https://www.wosign.com/)，申请成功后把下载下来的对应版本的证书文件上传到服务器上，包含公钥`.crt`和私钥`.key`。\n\n然后编辑`/etc/nginx/conf.d/default.conf`\n\n{% codeblock %}\nserver {\n    listen       80;\n    listen       443 ssl;\n    server_name  ppxu.me *.ppxu.me;\n\n    ssl on;\n    ssl_certificate /etc/nginx/conf.d/ppxu.crt;\n    ssl_certificate_key /etc/nginx/conf.d/ppxu.key;\n    ssl_session_timeout 5m;\n    ssl_protocols TLSv1 TLSv1.1 TLSv1.2;\n    ssl_ciphers 'AES128+EECDH:AES128+EDH:!aNULL';\n    ssl_prefer_server_ciphers on;\n    ssl_session_cache shared:SSL:10m;\n    ssl_session_timeout 10m;\n    ssl_stapling on;\n    ssl_stapling_verify on;\n\n    resolver 8.8.4.4 8.8.8.8 valid=300s;\n    resolver_timeout 10s;\n    add_header Strict-Transport-Security \"max-age=31536000; includeSubdomains\";\n\n    location / {\n        # root   /usr/share/nginx/html;\n        # index  index.html index.htm;\n        proxy_pass          http://127.0.0.1:4000/;\n        proxy_redirect      off;\n        proxy_set_header    X-Real-IP       $remote_addr;\n        proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;\n    }\n\n    ...\n{% endcodeblock %}\n\n重启nginx，如果一切顺利，现在就可以通过`https://ppxu.me`访问到本网站了，但是直接输入`ppxu.me`会报400错误，显示\n\n{% codeblock %}\nThe plain HTTP request was sent to HTTPS port\n{% endcodeblock %}\n\n我们需要将http的请求强制使用https访问，这里有一个方法是使用497错误码做重定向，在`/etc/nginx/conf.d/default.conf`中添加\n\n{% codeblock %}\nerror_page 497  https://$host$uri;\n{% endcodeblock %}\n\n这样我们的网站就已经完全支持了HTTPS访问，可以在这个网站[https://www.ssllabs.com/ssltest/analyze.html](https://www.ssllabs.com/ssltest/analyze.html)对网页进行安全评测，如果评分不够高的话可以再看看如何[加强nginx的SSL安全](http://www.oschina.net/translate/strong_ssl_security_on_nginx)\n\n#### 参考资料\n\n* [http://codybonney.com/installing-nginx-on-centos-6-4/](http://codybonney.com/installing-nginx-on-centos-6-4/)\n* [http://www.tuijiankan.com/2015/05/04/阿里云Centos6安装配置Nodejs、Nginx、Hexo操作记录/](http://www.tuijiankan.com/2015/05/04/%E9%98%BF%E9%87%8C%E4%BA%91Centos6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AENodejs%E3%80%81Nginx%E3%80%81Hexo%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/)\n* [http://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/](http://www.barretlee.com/blog/2015/10/05/how-to-build-a-https-server/)\n* [http://www.ha97.com/5194.html](http://www.ha97.com/5194.html)\n* [http://www.cnblogs.com/yanghuahui/archive/2012/06/25/2561568.html](http://www.cnblogs.com/yanghuahui/archive/2012/06/25/2561568.html)\n* [http://www.codeceo.com/article/nginx-ssl-nodejs.html](http://www.codeceo.com/article/nginx-ssl-nodejs.html)\n* [http://www.ttlsa.com/nginx/nginx-node-js/](http://www.ttlsa.com/nginx/nginx-node-js/)\n* [http://blog.csdn.net/wzy_1988/article/details/8549290](http://blog.csdn.net/wzy_1988/article/details/8549290)\n* [http://www.tutugreen.com/wordpress/upgrade-ssl/](http://www.tutugreen.com/wordpress/upgrade-ssl/)\n* [http://www.oschina.net/translate/strong_ssl_security_on_nginx](http://www.oschina.net/translate/strong_ssl_security_on_nginx)\n* [http://blog.jobbole.com/44844/](http://blog.jobbole.com/44844/)\n","slug":"config-ssl-in-nginx","published":1,"updated":"2015-12-19T15:09:15.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciid8zaq40000pexx8opvm6hv"},{"title":"阿里云ECS搭建hexo","date":"2015-12-19T02:31:27.000Z","_content":"最近刚撸了个阿里云ECS服务器来折腾，先搭个hexo博客，这里记录一下操作步骤。\n\n<!--more-->\n\n撸主选的是最便宜的阿里云ECS，应付日常小撸应该足够了，具体配置如下：\n\n{% codeblock %}\nCPU：1核\n内存：1024MB\n操作系统：CentOS 7.0 64位\n带宽：1Mbps\n{% endcodeblock %}\n\n下面是具体的手法：\n\n* 连接服务器\n\n{% codeblock %}\nssh root@xx.xx.xx.xx\n{% endcodeblock %}\n\n* 安装Nodejs环境\n\n  * 更新软件源\n\n  {% codeblock %}\n  yum -y update\n  {% endcodeblock %}\n\n  * 下载Nodejs\n\n  {% codeblock %}\n  cd /usr/local/src\n  wget http://nodejs.org/dist/node-latest.tar.gz\n  {% endcodeblock %}\n\n  * 解压\n\n  {% codeblock %}\n  tar zxf node-latest.tar.gz\n  cd node-v*.*.*\n  {% endcodeblock %}\n\n  * 编译安装\n\n  {% codeblock %}\n  ./configure\n  make\n  make install\n  {% endcodeblock %}\n\n  * 确认安装成功\n\n  {% codeblock %}\n  node -v\n  npm -v\n  {% endcodeblock %}\n\n* 安装hexo\n\n{% codeblock %}\nnpm install -g hexo-cli\nhexo init blog\ncd blog\nnpm install\n{% endcodeblock %}\n\n* 启动hexo\n\n{% codeblock %}\nhexo server    //普通启动\nhexo server &  //静默启动\n{% endcodeblock %}\n\n启动成功后就可以通过服务器的ip地址`xx.xx.xx.xx:4000`访问到页面了，当然我们并不想输端口号，所以最好把4000转到80上，这次先没有用上nginx的反向代理，只是用iptables做了一下转发处理。\n\n* 转到80端口\n\n编辑iptables文件\n\n{% codeblock %}\nvi /etc/sysconfig/iptables\n{% endcodeblock %}\n\n加上下面这段\n\n{% codeblock %}\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 4000 -j ACCEPT\n\n*nat\n-A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 4000\nCOMMIT\n{% endcodeblock %}\n\n重启iptables服务\n\n{% codeblock %}\nservice iptables restart\n{% endcodeblock %}\n\n然后就发现报错了\n\n{% codeblock %}\nFailed to restart iptables.service: Unit iptables.service failed to load: No such file or directory.\n{% endcodeblock %}\n\n查了一下原来是CentOS 7中的防火墙改成了firewalld，所以要换回iptables。\n\n{% codeblock %}\nsystemctl stop firewalld\nsystemctl mask firewalld\nyum install iptables-services\nsystemctl enable iptables\nservice iptables start\n{% endcodeblock %}\n\n这样就可以通过ip地址`xx.xx.xx.xx`访问网站了。\n\n* 域名解析\n\n再撸个域名`ppxu.me`，把`@`和`www`都解析到服务器ip地址就可以了。\n\n* git管理\n\n再配置一下git环境，以后就可以通过git来管理内容了。\n\n#### 参考资料\n\n* [https://hexo.io/zh-cn/docs/index.html](https://hexo.io/zh-cn/docs/index.html)\n* [http://wsgzao.github.io/post/hexo-guide/](http://wsgzao.github.io/post/hexo-guide/)\n* [http://zipperary.com/categories/hexo/](http://zipperary.com/categories/hexo/)\n* [http://www.jianshu.com/p/73779eacb494](http://www.jianshu.com/p/73779eacb494)\n* [http://www.tuijiankan.com/2015/05/04/阿里云Centos6安装配置Nodejs、Nginx、Hexo操作记录/](http://www.tuijiankan.com/2015/05/04/%E9%98%BF%E9%87%8C%E4%BA%91Centos6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AENodejs%E3%80%81Nginx%E3%80%81Hexo%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/)\n* [http://codybonney.com/installing-node-js-0-10-24-on-centos-6-4/](http://codybonney.com/installing-node-js-0-10-24-on-centos-6-4/)\n* [http://codybonney.com/redirect-port-80-to-another-port-using-iptables-on-centos/](http://codybonney.com/redirect-port-80-to-another-port-using-iptables-on-centos/)\n* [http://www.vkilo.com/rhel-7-iptables-service.html](http://www.vkilo.com/rhel-7-iptables-service.html)\n","source":"_posts/install-nodejs-and-hexo-in-aliyun-centos.md","raw":"title: 阿里云ECS搭建hexo\ndate: 2015-12-19 10:31:27\ncategories: blog\ntags: [aliyun, ecs, centos, nodejs, hexo]\n---\n最近刚撸了个阿里云ECS服务器来折腾，先搭个hexo博客，这里记录一下操作步骤。\n\n<!--more-->\n\n撸主选的是最便宜的阿里云ECS，应付日常小撸应该足够了，具体配置如下：\n\n{% codeblock %}\nCPU：1核\n内存：1024MB\n操作系统：CentOS 7.0 64位\n带宽：1Mbps\n{% endcodeblock %}\n\n下面是具体的手法：\n\n* 连接服务器\n\n{% codeblock %}\nssh root@xx.xx.xx.xx\n{% endcodeblock %}\n\n* 安装Nodejs环境\n\n  * 更新软件源\n\n  {% codeblock %}\n  yum -y update\n  {% endcodeblock %}\n\n  * 下载Nodejs\n\n  {% codeblock %}\n  cd /usr/local/src\n  wget http://nodejs.org/dist/node-latest.tar.gz\n  {% endcodeblock %}\n\n  * 解压\n\n  {% codeblock %}\n  tar zxf node-latest.tar.gz\n  cd node-v*.*.*\n  {% endcodeblock %}\n\n  * 编译安装\n\n  {% codeblock %}\n  ./configure\n  make\n  make install\n  {% endcodeblock %}\n\n  * 确认安装成功\n\n  {% codeblock %}\n  node -v\n  npm -v\n  {% endcodeblock %}\n\n* 安装hexo\n\n{% codeblock %}\nnpm install -g hexo-cli\nhexo init blog\ncd blog\nnpm install\n{% endcodeblock %}\n\n* 启动hexo\n\n{% codeblock %}\nhexo server    //普通启动\nhexo server &  //静默启动\n{% endcodeblock %}\n\n启动成功后就可以通过服务器的ip地址`xx.xx.xx.xx:4000`访问到页面了，当然我们并不想输端口号，所以最好把4000转到80上，这次先没有用上nginx的反向代理，只是用iptables做了一下转发处理。\n\n* 转到80端口\n\n编辑iptables文件\n\n{% codeblock %}\nvi /etc/sysconfig/iptables\n{% endcodeblock %}\n\n加上下面这段\n\n{% codeblock %}\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT\n-A INPUT -m state --state NEW -m tcp -p tcp --dport 4000 -j ACCEPT\n\n*nat\n-A PREROUTING -p tcp --dport 80 -j REDIRECT --to-ports 4000\nCOMMIT\n{% endcodeblock %}\n\n重启iptables服务\n\n{% codeblock %}\nservice iptables restart\n{% endcodeblock %}\n\n然后就发现报错了\n\n{% codeblock %}\nFailed to restart iptables.service: Unit iptables.service failed to load: No such file or directory.\n{% endcodeblock %}\n\n查了一下原来是CentOS 7中的防火墙改成了firewalld，所以要换回iptables。\n\n{% codeblock %}\nsystemctl stop firewalld\nsystemctl mask firewalld\nyum install iptables-services\nsystemctl enable iptables\nservice iptables start\n{% endcodeblock %}\n\n这样就可以通过ip地址`xx.xx.xx.xx`访问网站了。\n\n* 域名解析\n\n再撸个域名`ppxu.me`，把`@`和`www`都解析到服务器ip地址就可以了。\n\n* git管理\n\n再配置一下git环境，以后就可以通过git来管理内容了。\n\n#### 参考资料\n\n* [https://hexo.io/zh-cn/docs/index.html](https://hexo.io/zh-cn/docs/index.html)\n* [http://wsgzao.github.io/post/hexo-guide/](http://wsgzao.github.io/post/hexo-guide/)\n* [http://zipperary.com/categories/hexo/](http://zipperary.com/categories/hexo/)\n* [http://www.jianshu.com/p/73779eacb494](http://www.jianshu.com/p/73779eacb494)\n* [http://www.tuijiankan.com/2015/05/04/阿里云Centos6安装配置Nodejs、Nginx、Hexo操作记录/](http://www.tuijiankan.com/2015/05/04/%E9%98%BF%E9%87%8C%E4%BA%91Centos6%E5%AE%89%E8%A3%85%E9%85%8D%E7%BD%AENodejs%E3%80%81Nginx%E3%80%81Hexo%E6%93%8D%E4%BD%9C%E8%AE%B0%E5%BD%95/)\n* [http://codybonney.com/installing-node-js-0-10-24-on-centos-6-4/](http://codybonney.com/installing-node-js-0-10-24-on-centos-6-4/)\n* [http://codybonney.com/redirect-port-80-to-another-port-using-iptables-on-centos/](http://codybonney.com/redirect-port-80-to-another-port-using-iptables-on-centos/)\n* [http://www.vkilo.com/rhel-7-iptables-service.html](http://www.vkilo.com/rhel-7-iptables-service.html)\n","slug":"install-nodejs-and-hexo-in-aliyun-centos","published":1,"updated":"2015-12-19T04:34:15.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciid8zaqi000fpexxm4auagvc"},{"title":"Hello World","_content":"Welcome to [Hexo](http://hexo.io/)! This is your very first post. Check [documentation](http://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](http://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](http://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](http://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](http://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](http://hexo.io/docs/deployment.html)\n","source":"_posts/hello-world.md","raw":"title: Hello World\n---\nWelcome to [Hexo](http://hexo.io/)! This is your very first post. Check [documentation](http://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](http://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](http://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](http://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](http://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](http://hexo.io/docs/deployment.html)\n","slug":"hello-world","published":1,"date":"2015-12-18T14:31:17.000Z","updated":"2015-12-18T14:31:17.000Z","comments":1,"layout":"post","photos":[],"link":"","_id":"ciid8zaqm000opexxd1uaga1m"}],"PostAsset":[],"PostCategory":[{"post_id":"ciid8zaq40000pexx8opvm6hv","category_id":"ciid8zaq90001pexxp5rb146x","_id":"ciid8zaqc0004pexxwvy25qlq"},{"post_id":"ciid8zaqi000fpexxm4auagvc","category_id":"ciid8zaq90001pexxp5rb146x","_id":"ciid8zaqj000gpexx1y0dznpx"}],"PostTag":[{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqa0002pexx87dyeyse","_id":"ciid8zaqe0009pexxandvvtrh"},{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqc0003pexxlhzwvm4z","_id":"ciid8zaqf000apexxr0cmf4kh"},{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqd0005pexxdynenzmw","_id":"ciid8zaqf000bpexx2ox3giti"},{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqe0006pexxyyo4rin7","_id":"ciid8zaqg000cpexxyidd0f8u"},{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqe0007pexxxcniln0p","_id":"ciid8zaqg000dpexx3piyl3s6"},{"post_id":"ciid8zaq40000pexx8opvm6hv","tag_id":"ciid8zaqe0008pexxwc0nrl3z","_id":"ciid8zaqg000epexxzezvpo1q"},{"post_id":"ciid8zaqi000fpexxm4auagvc","tag_id":"ciid8zaqa0002pexx87dyeyse","_id":"ciid8zaqj000jpexxol212wsd"},{"post_id":"ciid8zaqi000fpexxm4auagvc","tag_id":"ciid8zaqc0003pexxlhzwvm4z","_id":"ciid8zaqk000kpexxr2y3iitf"},{"post_id":"ciid8zaqi000fpexxm4auagvc","tag_id":"ciid8zaqd0005pexxdynenzmw","_id":"ciid8zaqk000lpexxubjpptz1"},{"post_id":"ciid8zaqi000fpexxm4auagvc","tag_id":"ciid8zaqj000hpexx61iq9tut","_id":"ciid8zaqk000mpexxu2dk4b0u"},{"post_id":"ciid8zaqi000fpexxm4auagvc","tag_id":"ciid8zaqj000ipexxp28iyrwi","_id":"ciid8zaqk000npexxv3j7wbu7"}],"Tag":[{"name":"aliyun","_id":"ciid8zaqa0002pexx87dyeyse"},{"name":"ecs","_id":"ciid8zaqc0003pexxlhzwvm4z"},{"name":"centos","_id":"ciid8zaqd0005pexxdynenzmw"},{"name":"nginx","_id":"ciid8zaqe0006pexxyyo4rin7"},{"name":"ssl","_id":"ciid8zaqe0007pexxxcniln0p"},{"name":"https","_id":"ciid8zaqe0008pexxwc0nrl3z"},{"name":"nodejs","_id":"ciid8zaqj000hpexx61iq9tut"},{"name":"hexo","_id":"ciid8zaqj000ipexxp28iyrwi"}]}}